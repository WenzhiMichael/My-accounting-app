import { useStore } from './store'

export type Language = 'zh' | 'en'

export const translations = {
    en: {
        // Navigation & Common
        home: 'Home',
        overview: 'Overview',
        transactions: 'Transactions',
        accounts: 'Accounts',
        settings: 'Settings',
        add: 'Add',
        add_new: 'Add New',
        back: 'Back',
        save: 'Save',
        save_changes: 'Save changes',
        cancel: 'Cancel',
        delete: 'Delete',
        edit: 'Edit',
        done: 'Done',

        // Dashboard
        week: 'Week',
        month: 'Month',
        total_balance: 'Total Balance',
        income: 'Income',
        expense: 'Expense',
        spending_trend: 'Spending trend',
        last_6_months: 'Last 6 months',
        add_expenses_trend: 'Add expenses to see your trend.',
        all_expenses: 'All Expenses',
        all_income: 'All Income',
        category_breakdown: 'Category breakdown',
        expenses_only: 'Expenses only',
        add_expense_chart: 'Add an expense to see your chart.',
        recent_transactions: 'Recent Transactions',
        no_transactions: 'No transactions yet',
        no_transactions_cta: 'No transactions yet. Start by adding one.',
        accounts_this_period: 'Accounts this {{period}}',
        net_worth: 'Net worth',
        no_spending: 'No spending tracked this {{period}}.',
        spend_this_period: 'Spend this {{period}}',
        period_in_cad: 'This {{period}} in CAD',

        // Credit Cards
        credit_cards: 'Credit Cards',
        manage: 'Manage',
        no_credit_cards: 'No credit cards added',
        add_card: 'Add Card',
        bill_day: 'Bill Day',
        due_day: 'Due',
        balance: 'Balance',
        used: 'Used',
        limit: 'Limit',

        // Settings
        language: 'Language',
        theme: 'Theme',
        security: 'Security',
        app_lock: 'App Lock',
        passcode: 'Passcode',
        data_management: 'Data Management',
        export_data: 'Export Data',
        import_data: 'Import Data',
        settings_subtitle: 'Appearance, language and security',
        choose_language: 'Choose your preferred language.',
        language_zh: '简体中文',
        language_en: 'English',
        choose_theme: 'Choose light, dark, or follow system.',
        theme_system: 'System',
        theme_light: 'Light',
        theme_dark: 'Dark',
        require_biometrics: 'Require biometrics or passcode on launch.',
        enable: 'Enable',
        passcode_mismatch: 'Passcodes do not match.',
        passcode_saved: 'Passcode saved.',
        passcode_cleared: 'Passcode cleared.',
        passcode_confirm: 'Confirm Passcode',
        passcode_placeholder: 'Set a fallback passcode',
        passcode_repeat_placeholder: 'Repeat passcode',
        biometrics_note: 'Your device biometrics will be used when available. Passcode acts as a fallback.',
        backup_restore_description: 'Backup or restore your data locally.',
        import_confirm: 'Importing data will overwrite your current data. Continue?',
        import_success: 'Data imported successfully!',
        import_invalid: 'Invalid data file: missing accounts or transactions.',
        import_error: 'Error parsing JSON file.',

        // App Lock
        biometric_not_available: 'Biometric auth not available on this device.',
        auth_failed: 'Authentication failed or was cancelled.',
        no_passcode_set: 'No passcode set. Set one in Settings.',
        incorrect_passcode: 'Incorrect passcode.',
        unlock_to_continue: 'Unlock to continue',
        app_lock_enabled_message: 'App Lock is enabled. Use device biometrics or your passcode to unlock.',
        unlock_with_device: 'Unlock with device',
        use_passcode: 'Use passcode',
        passcode_if_set: 'Passcode (if set)',
        enter_passcode: 'Enter passcode',
        disable_app_lock: 'Disable App Lock for now',
        app_lock_tip: 'Tip: set a passcode in Settings as a fallback if biometrics are unavailable.',

        // Accounts
        no_accounts: 'No accounts yet',
        add_account: 'Add Account',
        add_first_account: 'Add your first bank card or cash account.',
        account_type_CREDIT: 'Credit Card',
        account_type_CASH: 'Cash',
        account_type_BANK: 'Debit Card',
        account_type_label: 'Account Type',
        account_name_label: 'Account Name',
        account_name_placeholder: 'e.g. TD Chequing',
        current_balance_label: 'Current Balance',
        current_balance_hint_credit: 'Negative for debt, positive for overpayment.',
        current_balance_hint_non_credit: 'Current money available.',
        credit_limit_label: 'Credit Limit',
        credit_limit_placeholder: 'e.g. 50000',
        billing_day_label: 'Billing Day',
        due_day_label: 'Due Day',
        day_placeholder: 'Day (1-31)',
        color_label: 'Color',
        save_account: 'Save Account',
        account_not_found: 'Account not found',
        back_to_accounts: 'Back to accounts',
        delete_account: 'Delete account',
        linked_transactions: 'Transactions: {{count}}',
        account_has_transactions: 'This account has transactions. Move them to another account before deleting.',

        // Validation
        missing_amount: 'Missing amount',
        choose_category: 'Choose a category',
        select_account: 'Select an account',
        ok: 'OK',

        // Forms
        amount: 'Amount',
        amount_cad: 'Amount (CAD)',
        category: 'Category',
        date: 'Date',
        note: 'Note',
        account: 'Account',
        type: 'Type',
        transfer: 'Transfer',
        optional_details: 'Optional details',
        choose_date: 'Choose date',
        recurring_one_time: 'One-time',
        recurring_daily: 'Daily',
        recurring_weekly: 'Weekly',
        recurring_monthly: 'Monthly',

        // List Views
        filter_by_account_date: 'Filter by account or date range',
        filtered_total: 'Filtered total',
        all_accounts: 'All accounts',
        no_expenses_match: 'No expenses match your filters.',
        no_income_match: 'No income records match your filters.',
        uncategorized: 'Uncategorized',
        unknown_account: 'Unknown account',

        // Transactions
        transactions_subtitle: 'Filtered activity across your accounts (CAD)',
        income_range: 'Income ({{range}})',
        expense_range: 'Expense ({{range}})',
        range_last_7_days: 'Last 7 days',
        range_last_30_days: 'Last 30 days',
        range_last_6_months: 'Last 6 months',
        range_overall: 'Overall',
        transaction_not_found: 'Transaction not found',
        transaction_deleted: 'It may have been deleted.',
        back_to_list: 'Back to list',
    },
    zh: {
        // Navigation & Common
        home: '首页',
        overview: '概览',
        transactions: '交易明细',
        accounts: '账户',
        settings: '设置',
        add: '记一笔',
        add_new: '快速记账',
        back: '返回',
        save: '保存',
        save_changes: '保存更改',
        cancel: '取消',
        delete: '删除',
        edit: '编辑',
        done: '完成',

        // Dashboard
        week: '本周',
        month: '本月',
        total_balance: '总余额',
        income: '收入',
        expense: '支出',
        spending_trend: '支出趋势',
        last_6_months: '最近6个月',
        add_expenses_trend: '添加支出后可查看趋势。',
        all_expenses: '全部支出',
        all_income: '全部收入',
        category_breakdown: '分类统计',
        expenses_only: '仅支出',
        add_expense_chart: '添加支出后可查看图表。',
        recent_transactions: '近期交易',
        no_transactions: '暂无交易记录',
        no_transactions_cta: '暂无交易记录，先添加一笔吧。',
        accounts_this_period: '{{period}}账户变动',
        net_worth: '净资产',
        no_spending: '{{period}}无支出。',
        spend_this_period: '{{period}}支出',
        period_in_cad: '{{period}}（加元）',

        // Credit Cards
        credit_cards: '信用卡',
        manage: '管理',
        no_credit_cards: '暂无信用卡',
        add_card: '添加信用卡',
        bill_day: '账单日',
        due_day: '还款日',
        balance: '余额',
        used: '已用',
        limit: '额度',

        // Settings
        language: '语言',
        theme: '主题',
        security: '安全',
        app_lock: '应用锁',
        passcode: '密码',
        data_management: '数据管理',
        export_data: '导出数据',
        import_data: '导入数据',
        settings_subtitle: '外观、语言与安全',
        choose_language: '选择你的语言偏好。',
        language_zh: '简体中文',
        language_en: 'English',
        choose_theme: '选择浅色、深色或跟随系统。',
        theme_system: '跟随系统',
        theme_light: '浅色',
        theme_dark: '深色',
        require_biometrics: '启动时需要生物识别或密码。',
        enable: '启用',
        passcode_mismatch: '两次输入的密码不一致。',
        passcode_saved: '密码已保存。',
        passcode_cleared: '密码已清除。',
        passcode_confirm: '确认密码',
        passcode_placeholder: '设置备用密码',
        passcode_repeat_placeholder: '再次输入密码',
        biometrics_note: '支持时将使用设备生物识别，密码作为备用。',
        backup_restore_description: '本地备份或恢复数据。',
        import_confirm: '导入数据将覆盖当前数据，继续吗？',
        import_success: '数据导入成功！',
        import_invalid: '数据文件无效：缺少账户或交易。',
        import_error: '解析 JSON 文件出错。',

        // App Lock
        biometric_not_available: '此设备不支持生物识别。',
        auth_failed: '认证失败或已取消。',
        no_passcode_set: '未设置密码，请在设置中设置。',
        incorrect_passcode: '密码错误。',
        unlock_to_continue: '解锁以继续',
        app_lock_enabled_message: '应用锁已启用，请使用生物识别或密码解锁。',
        unlock_with_device: '使用设备解锁',
        use_passcode: '使用密码',
        passcode_if_set: '密码（如已设置）',
        enter_passcode: '输入密码',
        disable_app_lock: '暂时关闭应用锁',
        app_lock_tip: '提示：若生物识别不可用，可在设置中设置密码作为备用。',

        // Accounts
        no_accounts: '暂无账户',
        add_account: '添加账户',
        add_first_account: '添加您的第一张银行卡或现金账户。',
        account_type_CREDIT: '信用卡',
        account_type_CASH: '现金',
        account_type_BANK: '借记卡',
        account_type_label: '账户类型',
        account_name_label: '账户名称',
        account_name_placeholder: '例如：招商银行',
        current_balance_label: '当前余额',
        current_balance_hint_credit: '负数表示欠款，正数表示多还。',
        current_balance_hint_non_credit: '当前可用余额。',
        credit_limit_label: '信用额度',
        credit_limit_placeholder: '例如：50000',
        billing_day_label: '账单日',
        due_day_label: '还款日',
        day_placeholder: '日期（1-31）',
        color_label: '颜色',
        save_account: '保存账户',
        account_not_found: '未找到账户',
        back_to_accounts: '返回账户列表',
        delete_account: '删除账户',
        linked_transactions: '交易数：{{count}}',
        account_has_transactions: '该账户存在交易，请先转移后再删除。',

        // Validation
        missing_amount: '请输入金额',
        choose_category: '请选择分类',
        select_account: '请选择账户',
        ok: '确定',

        // Forms
        amount: '金额',
        amount_cad: '金额（加元）',
        category: '分类',
        date: '日期',
        note: '备注',
        account: '账户',
        type: '类型',
        transfer: '转账',
        optional_details: '可选备注',
        choose_date: '选择日期',
        recurring_one_time: '单次',
        recurring_daily: '每日',
        recurring_weekly: '每周',
        recurring_monthly: '每月',

        // List Views
        filter_by_account_date: '按账户或日期筛选',
        filtered_total: '筛选合计',
        all_accounts: '全部账户',
        no_expenses_match: '没有匹配的支出记录。',
        no_income_match: '没有匹配的收入记录。',
        uncategorized: '未分类',
        unknown_account: '未知账户',

        // Transactions
        transactions_subtitle: '按账户筛选的交易（加元）',
        income_range: '收入（{{range}}）',
        expense_range: '支出（{{range}}）',
        range_last_7_days: '近7天',
        range_last_30_days: '近30天',
        range_last_6_months: '近6个月',
        range_overall: '全部',
        transaction_not_found: '未找到交易',
        transaction_deleted: '可能已被删除。',
        back_to_list: '返回列表',
    }
} as const

export type TxKey = keyof typeof translations.en

export function useTranslation() {
    const { preferences } = useStore()
    const lang = preferences.language || 'zh' // Default to Chinese if not set

    function t(key: TxKey, params?: Record<string, string>) {
        let text: string = translations[lang][key] || translations['en'][key] || key

        if (params) {
            Object.entries(params).forEach(([k, v]) => {
                text = text.replace(`{{${k}}}`, v)
            })
        }

        return text
    }

    return { t, lang }
}

